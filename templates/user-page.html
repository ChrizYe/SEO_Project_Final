{% extends "layout.html" %} {% block content %}

<!DOCTYPE html>
<html>
  <head> </head>
  <body>
    <header class="header">
      <div class="title-wrapper">
        <h1 class="title userpage">{{userName}}'s Page</h1>
      </div>
      <a href="{{url_for('main_page')}}" class="user-container">
        <p class="username">
          <i
            class="bi bi-house-fill"
            style="margin-right: 5px; display: inline"
          ></i
          >Home
        </p>
      </a>
    </header>

    <main class="main-container">
      <h1>Account Settings</h1>
      <!-- Flash Messages -->
      {% with messages = get_flashed_messages(with_categories=true) %} {% if
      messages %} {% for category, message in messages %}
      <div class="alert alert-{{ category }}">{{ message }}</div>
      {% endfor %} {% endif %} {% endwith %}

      <!-- Update Username -->
      <h2>Update Username</h2>
      <form method="POST" action="{{ url_for('user_page') }}">
        {{ username_form.hidden_tag() }}

        <label for="{{ username_form.username.id }}">New Username</label>
        {{ username_form.username() }} {% for error in
        username_form.username.errors %}
        <div class="error">{{ error }}</div>
        {% endfor %}

        <label for="{{ username_form.current_password.id }}"
          >Current Password</label
        >
        {{ username_form.current_password() }} {% for error in
        username_form.current_password.errors %}
        <div class="error">{{ error }}</div>
        {% endfor %} {{ username_form.submit_username() }}
      </form>

      <hr />

      <!-- Update Email -->
      <h2>Update Email</h2>
      <form method="POST" action="{{ url_for('user_page') }}">
        {{ email_form.hidden_tag() }}

        <label for="{{ email_form.email.id }}">New Email</label>
        {{ email_form.email() }} {% for error in email_form.email.errors %}
        <div class="error">{{ error }}</div>
        {% endfor %}

        <label for="{{ email_form.current_password.id }}"
          >Current Password</label
        >
        {{ email_form.current_password() }} {% for error in
        email_form.current_password.errors %}
        <div class="error">{{ error }}</div>
        {% endfor %} {{ email_form.submit_email() }}
      </form>

      <hr />

      <!-- Change Password -->
      <h2>Change Password</h2>
      <form method="POST" action="{{ url_for('user_page') }}">
        {{ password_form.hidden_tag() }}

        <label for="{{ password_form.current_password.id }}"
          >Current Password</label
        >
        {{ password_form.current_password() }} {% for error in
        password_form.current_password.errors %}
        <div class="error">{{ error }}</div>
        {% endfor %}

        <label for="{{ password_form.new_password.id }}">New Password</label>
        {{ password_form.new_password() }} {% for error in
        password_form.new_password.errors %}
        <div class="error">{{ error }}</div>
        {% endfor %}

        <label for="{{ password_form.confirm_new_password.id }}"
          >Confirm New Password</label
        >
        {{ password_form.confirm_new_password() }} {% for error in
        password_form.confirm_new_password.errors %}
        <div class="error">{{ error }}</div>
        {% endfor %} {{ password_form.submit_password() }}
      </form>
    </main>

    <main class="main-container">
      <a class="pagination-option" href="{{ url_for('logout') }}">Log out</a>
      <h1>Your Favorites</h1>

      {% if has_favorites %} {% for article in articles %}
      <a
        href="{{ url_for('show_fav_article', index=loop.index0 + ((current_page - 1) * 3)) }}"
      >
        <div class="news-container">
          <div class="news-img-div">
            <img src="{{article.urlToImage}}" alt="" />
          </div>
          <div class="info-container">
            <div class="news-title-date">
              <p>{{ article.title }}</p>
              <p>{{ article.author }}</p>
            </div>
            <p class="descriptions">{{ article.description }}</p>
          </div>
        </div>
      </a>
      {% endfor %}

      <div class="pagination">
        {% if current_page > 1 %}
        <a
          class="pagination-option"
          href="{{request.path }}?page={{current_page - 1}}"
          >Previous</a
        >
        {% endif %} {% if current_page < total_pages %}
        <a
          class="pagination-option"
          href="{{request.path }}?page={{current_page + 1}}"
          >Next</a
        >
        {% endif %}
      </div>
      {% endif %}
    </main>

    <div>NUM OF PAGES ------ {{total_pages}}</div>
  </body>
</html>

{% endblock content %}
